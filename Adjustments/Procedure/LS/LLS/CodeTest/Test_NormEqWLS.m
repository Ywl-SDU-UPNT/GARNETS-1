clear all;clc
% p==q
A=[2 6 -4;1 4 -5;6 -1 18];
P=eye(3);
L=[4;3;2];
[N U AP] = NormEqWLS(A,L,P)
%% else
% A=[2 6 -4;1 4 -5;6 -1 18];
% P=eye(3);
% P(3,:)=[];
% L=[4;3;2];
% [N U AP] = NormEqWLS(A,L,P)
%% Outputs:
 % p==q
 % N=[41 10 95;10 53 -62;95 -62 365]
 % U=[23;34;5]
 % AP=[2 1 6;6 4 -1;-4 -5 18]
 % else
 % N=[4 12 -8;12 36 -24;12 36 -24;-8 -24 16]
 % U=[8;24;-16]
 % AP=[2 0 0;6 0 0;-4 0 0]